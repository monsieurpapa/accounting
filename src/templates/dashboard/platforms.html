{% extends 'falcon_base.html' %}
{% load static %}
{% load static app_filters %}
{{ redirect_to_login_immediately }}
{% block rendered_variables %}
<script>
  var peer_path_bandwidth_data =  JSON.stringify([[0,0],[0,0]]);
  var peer_path_packet_loss_data =  JSON.stringify([[0,0],[0,0]])
  var peer_path_jitter_data = JSON.stringify([[0,0],[0,0]])
  var peer_path_latency_data = JSON.stringify([[0,0],[0,0]])

  // var top_sources_dataset = '{{ top_sources_dataset | safe }}';
  var selected_peers_geo_data = '{{ selected_peers_geo_data | safe }}';
  // var selected_node_geo_data = '{{ selected_node_geo_data | safe }}';
  var node_geo_data = '{{ node_geo_data | safe }}';
  var markers = JSON.stringify([]);
  var mapsPlaceholder = JSON.stringify([]);
</script>
{% endblock %}

{% block content %}
      <div class="container" data-layout="container-fluid">
        <script>
          var isFluid = JSON.parse(localStorage.getItem('isFluid'));
          if (isFluid) {
            var container = document.querySelector('[data-layout]');
            container.classList.remove('container');
            container.classList.add('container-fluid');
          }
        </script>
        <nav class="navbar navbar-light navbar-vertical navbar-expand-xl">
          <script>
            var navbarStyle = localStorage.getItem("navbarStyle");
            if (navbarStyle && navbarStyle !== 'transparent') {
              document.querySelector('.navbar-vertical').classList.add(`navbar-${navbarStyle}`);
            }
          </script>
          <div class="d-flex align-items-center">
            <div class="toggle-icon-wrapper">

              <button class="btn navbar-toggler-humburger-icon navbar-vertical-toggle" data-bs-toggle="tooltip" data-bs-placement="left" title="Toggle Navigation"><span class="navbar-toggle-icon"><span class="toggle-line"></span></span></button>

            </div><a class="navbar-brand" href="/">
              <div class="d-flex align-items-center py-3" id="main-logo"> 
              </div>
            </a>
          </div>
          <div class="collapse navbar-collapse" id="navbarVerticalCollapse">
            <div class="navbar-vertical-content scrollbar">
              <ul class="navbar-nav flex-column mb-3" id="navbarVerticalNav">
                <li class="nav-item">
                  <!-- parent pages--><!-- <a class="nav-link dropdown-indicator" href="#dashboard" role="button" data-bs-toggle="collapse" aria-expanded="true" aria-controls="dashboard"> -->
                 <a class="nav-link" href="{% url 'home' %}" role="button" aria-expanded="true" aria-controls="dashboard">
                    <div class="d-flex align-items-center"><span class="nav-link-icon"><span class="fas fa-chart-pie"></span></span><span class="nav-link-text ps-1">Dashboard</span>
                    </div>
                  </a>
                  <!-- parent pages--><a class="nav-link" href="{% url 'routers_page' %}" role="button" data-bs-toggle="" aria-expanded="false">
                    <div class="d-flex align-items-center"><span class="nav-link-icon"><span class="fas fa-poll"></span></span><span class="nav-link-text ps-1">Routers</span>
                    </div>
                  </a>                  
                  <!-- parent pages--><a class="nav-link" href="{% url 'topology_page' %}" role="button" data-bs-toggle="" aria-expanded="false" aria-controls="maps">
                    <div class="d-flex align-items-center"><span class="nav-link-icon"><span class="fas fa-map"></span></span><span class="nav-link-text ps-1">Topology</span>
                    </div>
                  </a>
                  <!-- parent pages--><a class="nav-link" href="{% url 'alarms:all' %}" role="button" data-bs-toggle="" aria-expanded="false" aria-controls="maps">
                    <div class="d-flex align-items-center"><span class="nav-link-icon"><span class="fas fa-bell"></span></span><span class="nav-link-text ps-1">Alarms</span>
                    </div>
                  </a>                  
                  <!-- parent pages--><a class="nav-link" href="{% url 'user_profile' %}" role="button" data-bs-toggle="" aria-expanded="false" aria-controls="user">
                    <div class="d-flex align-items-center"><span class="nav-link-icon"><span class="fas fa-user"></span></span><span class="nav-link-text ps-1">Profile</span>
                    </div>
                  </a>
                  {% if perms.app_auth.is_super_admin %}
                  <!-- parent pages--><a class="nav-link dropdown-indicator active" href="#admin" role="button" data-bs-toggle="collapse" aria-expanded="true" aria-controls="admin">
                    <div class="d-flex align-items-center"><span class="nav-link-icon"><span class="fas fa-wrench"></span></span><span class="nav-link-text ps-1">Admin</span>
                    </div>
                  </a>
                  <ul class="nav" id="admin">
                    <li class="nav-item"><a class="nav-link active" href="{% url 'platform_list' %}" data-bs-toggle="" aria-expanded="false">
                        <div class="d-flex align-items-center"><span class="nav-link-text ps-1">Platforms</span>
                        </div>
                      </a>
                      <!-- more inner pages-->
                    </li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'account_detail_view' %}" data-bs-toggle="" aria-expanded="false">
                        <div class="d-flex align-items-center"><span class="nav-link-text ps-1">Customers</span>
                        </div>
                      </a>
                      <!-- more inner pages-->
                    </li>
                    <li class="nav-item"><a class="nav-link" href="{% url 'influxdb:nodes_report' %}" data-bs-toggle="" aria-expanded="false">
                      <div class="d-flex align-items-center"><span class="nav-link-text ps-1">Reports</span>
                      </div>
                    </a>
                    <!-- more inner pages-->
                  </li>                    
                    <li class="nav-item"><a class="nav-link" href="{% url 'user_list' %}" data-bs-toggle="" aria-expanded="false">
                        <div class="d-flex align-items-center"><span class="nav-link-text ps-1">Users</span>
                        </div>
                      </a>
                      <!-- more inner pages-->
                    </li>
                  </ul>
                  {% endif %}

                </li>
              </ul>
              <div class="settings mb-3">
                <div class="card alert p-0 shadow-none bg-transparent light" role="alert">
                  <div class="card-body text-left">
                    <!-- <img src="{% static 'falcon/assets/img/icons/spot-illustrations/navbar-vertical.png' %}" alt="" width="80" /> -->
                    <img src="{% static 'falcon/assets/img/logos/cran/png/logo-with-grey.png' %}" alt="" width="150" />
                  </div>                                  
                </div>
              </div>
            </div>
          </div>
        </nav>
        <div class="content">
          <nav class="navbar navbar-light navbar-glass navbar-top navbar-expand">
            <button class="btn navbar-toggler-humburger-icon navbar-toggler me-1 me-sm-3" type="button" data-bs-toggle="collapse" data-bs-target="#navbarVerticalCollapse" aria-controls="navbarVerticalCollapse" aria-expanded="false" aria-label="Toggle Navigation"><span class="navbar-toggle-icon"><span class="toggle-line"></span></span></button>
            <a class="navbar-brand me-1 me-sm-3" href="/">
              <div class="d-flex align-items-center py-3"><img class="me-2" src="{% static 'falcon/assets/img/icons/cmc-logo.png' %}" alt="" width="100" />
                <!-- <span class="font-sans-serif">falcon</span> -->
              </div>
            </a>
            <ul class="navbar-nav align-items-center d-none d-lg-block">
              <li class="nav-item">
                <!-- <div class="search-box" data-list='{"valueNames":["title"]}'> -->
                  <div class="search-box">
                  <form class="position-relative" data-bs-toggle="search" data-bs-display="static">
                    <input class="form-control search-input fuzzy-search" type="search" placeholder="" aria-label="Search" disabled />
                    <span class="fas fa-search search-box-icon"></span>
                  </form>
                  <div class="btn-close-falcon-container position-absolute end-0 top-50 translate-middle shadow-none" data-bs-dismiss="search">
                    <div class="btn-close-falcon" aria-label="Close"></div>
                  </div>
                  <div class="dropdown-menu border font-base start-0 mt-2 py-0 overflow-hidden w-100">
                  </div>
                </div>
              </li>
            </ul>
            <ul class="navbar-nav navbar-nav-icons ms-auto flex-row align-items-center">
              <li class="nav-item">
                <div class="theme-control-toggle fa-icon-wait px-2">
                  <input class="form-check-input ms-0 theme-control-toggle-input" id="themeControlToggle" type="checkbox" data-theme-control="theme" value="dark" />
                  <label class="mb-0 theme-control-toggle-label theme-control-toggle-light" for="themeControlToggle" data-bs-toggle="tooltip" data-bs-placement="left" title="Switch to light theme"><span class="fas fa-sun fs-0"></span></label>
                  <label class="mb-0 theme-control-toggle-label theme-control-toggle-dark" for="themeControlToggle" data-bs-toggle="tooltip" data-bs-placement="left" title="Switch to dark theme"><span class="fas fa-moon fs-0"></span></label>
                </div>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link notification-indicator notification-indicator-primary px-0 fa-icon-wait" id="navbarDropdownNotification" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-hide-on-body-scroll="data-hide-on-body-scroll"><span class="fas fa-bell" data-fa-transform="shrink-6" style="font-size: 33px;"></span></a>
                <div class="dropdown-menu dropdown-menu-end dropdown-menu-card dropdown-menu-notification dropdown-caret-bg" aria-labelledby="navbarDropdownNotification">
                </div>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link fa-icon-wait nine-dots p-1" id="navbarDropdownMenu" role="button" data-hide-on-body-scroll="data-hide-on-body-scroll" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="43" viewBox="0 0 16 16" fill="none">
                    <circle cx="2" cy="2" r="2" fill="#6C6E71"></circle>
                    <circle cx="2" cy="8" r="2" fill="#6C6E71"></circle>
                    <circle cx="2" cy="14" r="2" fill="#6C6E71"></circle>
                    <circle cx="8" cy="8" r="2" fill="#6C6E71"></circle>
                    <circle cx="8" cy="14" r="2" fill="#6C6E71"></circle>
                    <circle cx="14" cy="8" r="2" fill="#6C6E71"></circle>
                    <circle cx="14" cy="14" r="2" fill="#6C6E71"></circle>
                    <circle cx="8" cy="2" r="2" fill="#6C6E71"></circle>
                    <circle cx="14" cy="2" r="2" fill="#6C6E71"></circle>
                  </svg></a>
              </li>
              <li class="nav-item dropdown"><a class="nav-link pe-0 ps-2" id="navbarDropdownUser" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <div class="avatar avatar-xl">                    
                    {% if user.avatar %}
                    <img class="rounded-circle" src="{{ user.avatar.name | minio_presigned_get_url }}" alt="" />
                    {% else %}                    
                    <img class="rounded-circle" src="{% static 'falcon/assets/img/team/3-thumb.png' %}" alt="" />
                    {% endif %}  
                  </div>
                </a>
                <div class="dropdown-menu dropdown-menu-end py-0" aria-labelledby="navbarDropdownUser">
                  <div class="bg-white dark__bg-1000 rounded-2 py-2">
                    <a class="dropdown-item fw-bold text-warning" href="{% url 'user_profile' %}"><span class="fas fa-user me-1"></span><span>{{ user.display_name }}</span></a>

                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="{% url 'user_profile' %}">Profile</a>
                    <div class="dropdown-divider"></div>
                    {% if qty_accounts > 1 %}
                      <a class="dropdown-item" href="{% url 'switch_account' %}">Switch Profile</a>
                    {% endif %}
                    <a class="dropdown-item" href="{% url 'account_logout' %}">Logout</a>
                  </div>
                </div>
              </li>
            </ul>
          </nav>

          <div class="row g-3 mb-3">
            <div class="col-md-6 col-xxl-4">
              <div class="card h-md-100 ecommerce-card-min-width">
              <!-- <div class="card overflow-hidden" style="min-width: 12rem"> -->
                <div class="bg-holder bg-card" style="background-image:url({% static 'falcon/assets/img/icons/spot-illustrations/corner-1.png' %});">
                </div>                
                  <div class="card-header pb-0 position-relative">
                    <h5 class="mb-0 text-nowrap py-2 py-xl-0">
                      <div>
                          <span class="ms-1 text-400" data-bs-toggle="tooltip" data-bs-placement="top" title="The total number of network platforms that have been loaded">                        
                            <span class="text-warning">All Platforms</span>
                          </span>
                      </div>                                      
                    </h5>                  
                  </div>  
                <div class="card-body d-flex flex-column justify-content-end position-relative">
                  <div class="row">
                    <div class="col">
                      <p class="font-sans-serif lh-1 mb-1 fs-2 text-warning" id="total-conductor-count">
                        {{ conductors.count }}
                      </p>                                         
                    </div>
                    <div class="col-auto ps-0">             
                      <!-- <div class="echart-bar-weekly-sales h-100 echart-bar-weekly-sales-smaller-width"></div> -->
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-6 col-xxl-4">
              <div class="card h-md-100 ecommerce-card-min-width">                
                  <div class="bg-holder bg-card" style="background-image:url({% static 'falcon/assets/img/icons/spot-illustrations/corner-3.png'  %});">
                  </div>                
                  <div class="card-header pb-0 position-relative">
                    <h5 class="mb-0 text-nowrap py-2 py-xl-0">
                      <div>
                          <span class="ms-1 text-400" data-bs-toggle="tooltip" data-bs-placement="top" title="The total number of 128T conductors that have been loaded">                        
                            <span class="text-info">128T Conductors</span>
                          </span>
                      </div>                                      
                    </h5>                  
                  </div>  
                  <div class="card-body d-flex flex-column justify-content-end position-relative">
                    <div class="row">
                      <div class="col">
                        <p class="font-sans-serif lh-1 mb-1 fs-2 text-info" id="128t-conductor-count">
                          {{ conductors.count }}
                        </p>
                        <div id="selected-router-status">
                        </div>
                      </div>
                      <div class="col-auto ps-0">
                        <!-- <div class="echart-bar-weekly-sales h-100 echart-bar-weekly-sales-smaller-width"></div> -->
                      </div>                    
                    </div>
                  </div>                
              </div>
            </div>  
            <div class="col-md-6 col-xxl-4">
              <div class="card h-md-100 ecommerce-card-min-width">
                <div class="bg-holder bg-card" style="background-image:url({% static 'falcon/assets/img/icons/spot-illustrations/corner-2.png' %});">
                </div>
                  <div class="card-header pb-0 position-relative">
                    <h5 class="mb-0 text-nowrap py-2 py-xl-0">
                      <div>
                          <span class="ms-1 text-400" data-bs-toggle="tooltip" data-bs-placement="top" title="The total number of platform other than 128T conductors">                        
                            <span class="text-primary">Other Platforms</span>
                          </span>
                      </div>                                      
                    </h5>                  
                  </div>  
                <div class="card-body d-flex flex-column justify-content-end position-relative">
                  <div class="row">                                   
                    <div class="col">
                      <p class="font-sans-serif lh-1 mb-1 fs-2 text-primary" id="other-platforms-count">
                        0
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>  

          <div class="row g-3 mb-3">
            <div class="col-md-12 col-xxl-12">
              <div class="card h-100 " id="customers-page-customers-table" data-list='{"valueNames":["name","org","parent","type","menu","domains"],"page":10,"pagination":true,"fallback":"pages-table-fallback"}'>
                <div class="card-header">
                  <div class="row flex-between-center">
                    <div class="col-auto col-sm-8 col-lg-8">                                           
                      <h5 class="mb-0 text-nowrap py-2 py-xl-0">
                        <span>Platforms &nbsp;</span>(<span>{{ conductors.count }}</span>)
                      </h5>
                    </div>
                    <div class="col-auto col-sm-4 col-lg-4"> 
                      <div class="col-auto d-flex">
                        <h5 class="mb-0 text-nowrap py-2 py-xl-0">
                          <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#modal-create-conductor" id="button-form-create-conductor">Add a new Platform</button>
                        </h5>
                      </div>
                    </div>                    
                  </div>
                </div>
                <div class="card-body px-0 py-0">
                  <div class="table-responsive scrollbar">
                    <table class="table fs--1 mb-0 overflow-hidden table-hover">
                      <thead class="bg-200 text-900">
                        <tr>
                          <th class="sort pe-1 align-middle white-space-nowrap" data-sort="name">Name</th>
                          <th class="sort pe-1 align-middle white-space-nowrap" data-sort="org">Description</th>
                          <th class="sort pe-1 align-middle white-space-nowrap" data-sort="parent">URL</th>
                          <th class="sort pe-1 align-middle white-space-nowrap" data-sort="type">Status</th>
                          <th class="sort pe-1 align-middle white-space-nowrap" data-sort="menu"></th>
                        </tr>
                      </thead>
                      <tbody class="list" id='all-customers'>  
                        {% for conductor in conductors %}
                          <tr class="hover-actions-trigger">
                            <td class="align-middle text-nowrap">
                              <div class="d-flex align-items-center">
                                <div class="ms-2">{{ conductor.name }}</div>
                              </div>
                            </td>
                            <td class="align-middle text-nowrap">{{ conductor.description }}</td>
                            <td class="align-middle text-nowrap">{{ conductor.url }}</td>                            
                            <td class="align-middle text-nowrap"><div id="conductor-status-{{ forloop.counter }}">{{ conductor.status }}</div></td>                            
                            <td class="w-auto">
                              <div class="btn-group btn-group hover-actions end-0 me-4">
                                                            
                                <a href="#" data-bs-toggle="modal" data-bs-target="#modal-edit-conductor-{{ forloop.counter }}">
                                  <button class="btn btn-light ps-2" type="button" data-bs-toggle="tooltip" data-bs-placement="top" title="Edit Platform" >
                                      <span class="fas fa-edit"></span>
                                  </button> 
                                </a> 
                                                              
                                <a href="{% url 'delete_conductor' conductor.name %}">
                                  <button class="btn btn-light ps-2" type="button" data-bs-toggle="tooltip" data-bs-placement="top" title="Delete Platform">
                                    <span class="fas fa-trash-alt"></span>
                                  </button>
                                </a>                                  
                              </div>
                            </td>
                          </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                    <div class="text-center d-none spinner-grow" role="status" id='peer-paths-loading'></div>
                  </div>

                  <div class="text-center d-none" id="pages-table-fallback">
                    <p class="fw-bold fs-1 mt-3">No Page found</p>
                  </div>
                </div>
                <div class="card-footer">
                  <div class="row align-items-center">
                    <div class="pagination d-none"></div>
                    <div class="col">
                      <p class="mb-0 fs--1"><span class="d-none d-sm-inline-block me-2" data-list-info="data-list-info"></span></p>
                    </div>
                    <div class="col-auto d-flex">
                      <button class="btn btn-sm btn-primary" type="button" data-list-pagination="prev"><span>Previous</span></button>
                      <button class="btn btn-sm btn-primary px-4 ms-2" type="button" data-list-pagination="next"><span>Next</span></button>
                    </div>
                  </div>
                </div>
              </div>
            </div>            
            <!-- end peer paths section -->
        </div>
        {% include 'includes/footer.html' %}
        </div>
      </div>
      <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#loading-modal" id="loading-button" hidden>
      </button>
      
{% if update_conductor_forms %}
{% for update_conductor_form in update_conductor_forms %}
      <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#modal-edit-conductor-{{ forloop.counter }}" id="button-form-edit-conductor-{{ forloop.counter }}" hidden>
      </button>
      <div class="modal fade" id="modal-edit-conductor-{{ forloop.counter }}" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 650px">
          <div class="modal-content position-relative">
            <div class="position-absolute top-0 end-0 mt-2 me-2 z-index-1">
              <button class="btn-close btn btn-sm btn-circle d-flex flex-center transition-base" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
              <h4 class="mb-1" id="modalExampleDemoLabel">Edit Platform information </h4>
            </div>              
              <div class="p-4 pb-0">
                <form id="form-customer-profile" method="post" action="{% url 'update_conductor' update_conductor_form.form.conductor.name %}">
                  {% csrf_token %}                  
                      <div class="mb-3">
                        <label for="id_customer_name">Conductor Name</label>
                        {{ update_conductor_form.form.name }}
                        {{ update_conductor_form.form.name.errors }}
                      </div>
                      <div class="mb-3">
                        <label for="id_business_profile">Username</label>
                        {{ update_conductor_form.form.username }}
                        {{ update_conductor_form.form.username.errors }}
                      </div>
                      <div class="mb-3">
                        <label for="erp_code">Password</label>
                        {{ update_conductor_form.form.password }}
                        {{ update_conductor_form.form.password.errors }}
                      </div>                      
                      <div class="mb-3">
                        <label for="customer_type">URL</label>
                        {{ update_conductor_form.form.url }}
                        {{ update_conductor_form.form.url.errors }}
                      </div>       
                      <br>
                      <br>       
                      <div class="mb-3">
                        <button type="submit" name="submit" class="btn btn-primary d-block w-100 mt-3">Save Changes</button>
                        <button type="button" class="btn btn-warning d-block w-100 mt-3" data-bs-dismiss="modal">Cancel</button>                        
                      </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>  
  {% endfor %}    
{% endif %}
  <div class="modal fade" id="modal-create-conductor" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 650px">
      <div class="modal-content position-relative">
        <div class="position-absolute top-0 end-0 mt-2 me-2 z-index-1">
          <button class="btn-close btn btn-sm btn-circle d-flex flex-center transition-base" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
        <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
          <h4 class="mb-1" id="modalExampleDemoLabel">Add a new Platform</h4>
        </div>              
          <div class="p-4 pb-0">
            <form id="form-create-conductor" method="post" action="{% url 'create_conductor' %}">
              {% csrf_token %}
              {% for field in create_conductor_form %}
                  <div class="mb-3">                                                              
                      {{ field.label_tag}}                        
                      {{ field }}     
                      {% for error in field.errors %}
                        <span style="color: red;" >{{ error }}</span>
                      {% endfor %}                   
                  </div>
              {% endfor %}        
                <br>
                <br>       
                <div class="mb-3">
                  <button type="submit" name="submit" class="btn btn-primary d-block w-100 mt-3">Create Platform</button>
                  <button type="button" class="btn btn-warning d-block w-100 mt-3" data-bs-dismiss="modal">Cancel</button>                        
                </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div> 

{% if delete_conductor %}
  <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#modal-delete-conductor" id="button-form-delete-conductor" hidden>
  </button>
  <div class="modal fade" id="modal-delete-conductor" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 650px">
      <div class="modal-content position-relative">
        <div class="position-absolute top-0 end-0 mt-2 me-2 z-index-1">
          <button class="btn-close btn btn-sm btn-circle d-flex flex-center transition-base" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
        <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
          <h4 class="mb-1" id="modalExampleDemoLabel">Delete Platform</h4>
        </div>              
          <div class="p-4 pb-0">
            <form id="form-delete-conductor" method="post" action="{% url 'delete_conductor' conductor.name %}">
              {% csrf_token %}
              {% for error in form.non_field_errors %}
                {% if error %}<span style="color: red;" >{{ error }}</span>{% endif %}
              {% endfor %}                    
                <br>
              <h5 class="mb-1">
                Hey {{ user.first_name }}, are you sure you want to delete <b>{{ conductor.name }}</b>?
              </h5>                
                <br>       
                <div class="mb-3">
                  <button type="submit" name="submit" class="btn btn-primary d-block w-100 mt-3">Delete Platform</button>
                  <button type="button" class="btn btn-warning d-block w-100 mt-3" data-bs-dismiss="modal">Cancel</button>                        
                </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div> 
{% endif %}

{% if form.errors %}
  {% if form.instance.name %}
      <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#modal-udpate-conductor-error" id="button-form-update-conductor-error" hidden>
      </button>
      <div class="modal fade" id="modal-udpate-conductor-error" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 650px">
          <div class="modal-content position-relative">
            <div class="position-absolute top-0 end-0 mt-2 me-2 z-index-1">
              <button class="btn-close btn btn-sm btn-circle d-flex flex-center transition-base" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
              <h4 class="mb-1" id="modalExampleDemoLabel">Edit platform information</h4>
            </div>              
              <div class="p-4 pb-0">
                <form id="form-customer-profile" method="post" action="{% url 'update_conductor' form.instance.name %}">
                  {% csrf_token %}
                  {% for error in form.non_field_errors %}
                    {% if error %}<span style="color: red;" >{{ error }}</span>{% endif %}
                  {% endfor %}                   
                  {% for field in form %}
                      <div class="mb-3">                                                              
                          {{ field.label_tag}}                        
                          {{ field }}     
                          {% for error in field.errors %}
                            <span style="color: red;" >{{ error }}</span>
                          {% endfor %}                   
                      </div>
                  {% endfor %}        
                    <br>
                    <br>       
                    <div class="mb-3">
                      <button type="submit" name="submit" class="btn btn-primary d-block w-100 mt-3">Save Changes</button>
                      <button type="button" class="btn btn-warning d-block w-100 mt-3" data-bs-dismiss="modal">Cancel</button>                        
                    </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>      
    {% endif %}      
      <!-- create conductor error form -->
      <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#modal-create-conductor-error" id="button-form-create-conductor-error" hidden>
      </button>
      <div class="modal fade" id="modal-create-conductor-error" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document" style="max-width: 650px">
          <div class="modal-content position-relative">
            <div class="position-absolute top-0 end-0 mt-2 me-2 z-index-1">
              <button class="btn-close btn btn-sm btn-circle d-flex flex-center transition-base" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
              <h4 class="mb-1" id="modalExampleDemoLabel">Add a new Platform</h4>
            </div>              
              <div class="p-4 pb-0">
                <form id="form-create-conductor-error" method="post" action="{% url 'create_conductor' %}">
                  {% csrf_token %}
                  {% for error in form.non_field_errors %}
                    {% if error %}<span style="color: red;" >{{ error }}</span>{% endif %}
                  {% endfor %}                   
                  {% for field in form %}
                      <div class="mb-3">                                                              
                          {{ field.label_tag}}                        
                          {{ field }}     
                          {% for error in field.errors %}
                            <span style="color: red;" >{{ error }}</span>
                          {% endfor %}                   
                      </div>
                  {% endfor %}        
                    <br>
                    <br>       
                    <div class="mb-3">
                      <button type="submit" name="submit" class="btn btn-primary d-block w-100 mt-3">Create Platform</button>
                      <button type="button" class="btn btn-warning d-block w-100 mt-3" data-bs-dismiss="modal">Cancel</button>
                    </div>
                </form>                
              </div>
            </div>
          </div>
        </div>
      </div>     
   
  {% endif %}
  
{% endblock %}

{% block extra_js %}
                                           
{% if form.errors %}
  {% if create_conductor %}
    <script>
      $('#button-form-create-conductor-error').click();
    </script>  
  {% elif update_conductor %} 
    <script>
      $('#button-form-update-conductor-error').click();
    </script>
  {% endif %}
{% else %}
  {% if create_conductor %}
      <script>
        $('#button-form-create-conductor').click();
      </script> 
  {% endif %}
  {% if delete_conductor %} 
      <script>
        $('#button-form-delete-conductor').click();
      </script> 
  {% endif %}
{% endif %}


<script>
$(function() {  
  });

function getConductorStatus(selected_node_status){          
  if(selected_node_status=='RUNNING'){
    node_status_span='<span class="badge badge-soft-success rounded-pill fs--2">'+selected_node_status+'</span>';
  }else if(selected_node_status=='UNKNOWN'){
    node_status_span='<span class="badge badge-soft-warning rounded-pill fs--2">'+selected_node_status+'</span>';
  }else{
    node_status_span='<span class="badge badge-soft-danger rounded-pill fs--2">'+selected_node_status+'</span>';
  }
  return node_status_span;
}
</script>

{% for conductor in conductors %}    
  <script>
    var selected_node_status = '{{ conductor.status }}';
    $('#conductor-status-{{ forloop.counter }}').empty();
    $('#conductor-status-{{ forloop.counter }}').append(getConductorStatus(selected_node_status))
  </script>     
{% endfor %}

{% endblock %}


